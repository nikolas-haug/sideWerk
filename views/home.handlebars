<!-- Nav -->
<nav class="navbar navbar-expand-lg navbar-light bg-light">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="#">Navbar</a>

  <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
      <li class="nav-item active">
        <a class="nav-link" href="/home">Home</a></li>
        <li class="nav-item active">
        <a class="nav-link" href="/create">Create new list</a></li>
        <li class="nav-item active">
        <a class="nav-link" href="/profile">Profile</a></li>
        <li class="nav-item active">
        <a class="nav-link" href="/board">View list board</a></li>
        <li class="nav-item active">

            {{!-- view the lists you've created or joined --}}

            <li class="nav-item active">
<a class="nav-link" href="/owned">View your created lists</a></li>
<li class="nav-item active">
<a class="nav-link" href="/joined">Your joined lists</a></li>
        <a class="nav-link" href="/logout">Logout</a></li>

<hr>


        <a class="nav-link disabled" href="#">Disabled</a></li>
      </li>
    </ul>
    <form class="form-inline my-2 my-lg-0">
      <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
    </form>
  </div>
</nav>
<!-- end Nav -->


<!-- page wrapper -->
<div class="container">
    <div class="row justify-content-md-center">

<!-- header -->
<div class="card" style="width: 50rem;">
     <img src="../public/assets/images/logo-2.png" class="card-img-top" alt="Side Werk logo">
     <div class="card-body align-self-center">
        <h1 class="card-titler">Home Page</h1>
        <h3 class="card-text align-self-center">let's get to werk!</p>


            <div class="container">
            <div class="list-group">
  <a href="#" class="list-group-item list-group-item-action active">
    Cras justo odio
  </a>
  <p><a href="#" class="list-group-item list-group-item-action">Dapibus ac facilisis in</a></p>
  <a href="#" class="list-group-item list-group-item-action">Morbi leo risus</a>
  <a href="#" class="list-group-item list-group-item-action">Porta ac consectetur ac</a>
  <a href="#" class="list-group-item list-group-item-action disabled">Vestibulum at eros</a>
</div></div>



<h1>{{message}}</h1>


<!-- header ends -->

<hr>

<a href="/create">create new list</a>
<a href="/board">view list board</a>

<br>

{{!-- check if a user is logged in - conditionally render login/signup --}}
{{#unless user}}


    <a href="/login" class="btn btn-primary">Login</a>
    <a href="/signup" class="btn btn-primary">Sign up</a>
{{/unless}}

<hr>




<a href="/logout">Logout</a>
</div>
</div>
</div>
<!-- End of row -->
</div>
<!-- page wrapper ends -->
</div>

















<!-- TRANFER -->



{{!-- display the user's owned and joined lists if they exist --}}

{{#if user_lists}}
    <h1>Your Created Lists</h1>
    {{!-- <ul>
        {{#each user_lists}}
            <li>{{this.list_name}}</li>
        {{/each}}
    </ul> --}}
    {{#each user_lists}}
        <p>{{this.list_name}} <span><button class="owned-list-btn" data-owned_list_id="{{this.id}}">view/edit</button></span></p>
    {{/each}}
{{/if}}

{{!-- <span><button>view/edit</button></span> --}}

{{!-- {{#if joined_lists.confirmed}} --}}

    <hr>

    {{#if joined_lists}}
        <h2>Lists You've Joined</h2>
    {{/if}}

    {{#each joined_lists}}
        {{#if this.confirmed}}
            <p>{{this.list_name}}</p>
            <button class="joined-list-btn" data-owned_list_id="{{this.listID}}">Proceed to list</button>
            {{else}}
            <h5>{{this.list_name}} --> <span>PENDING APPROVAL!</span></h5>
        {{/if}}
    {{/each}}

    {{!-- <h1>Lists You've Joined</h1>
    {{#each joined_lists}}
        <p>{{this.list_name}}</p>
    {{/each}} --}}
{{!-- {{/if}} --}}

<script>

    // GET REQUEST for the owned list 
    // make the variables
    const ownedListButtons = document.querySelectorAll('.owned-list-btn');
    const joinedListButtons= document.querySelectorAll('.joined-list-btn');

    ownedListButtons.forEach(listBtn => listBtn.addEventListener('click', getownedListData));
    joinedListButtons.forEach(listBtn => listBtn.addEventListener('click', getownedListData));

    function getownedListData(e) {

        console.log(e);

        let listButtonDataId = e.target.dataset.owned_list_id;
        
        $.ajax({
            
            type: 'GET',
            url: `/list/active/${listButtonDataId}`,
            dataType: "text",
            success: function(resultData) {
                window.location.href = `/list/active/${listButtonDataId}`;
            }
        }); 

    }

</script>